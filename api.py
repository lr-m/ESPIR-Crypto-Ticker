import flask
from flask import request, jsonify

app = flask.Flask(__name__)
app.config["DEBUG"] = True

# Create some test data for our catalog in the form of a list of dictionaries.
coins = [
    {'id': 'BTC',
     'name': 'bitcoin',
     'bitmap': '0x00, 0x07, 0x0e, 0x00, 0x00, 0x00, 0x07, 0x0e, 0x00, 0x00, 0x00, 0x07, 0x0e, 0x00, 0x00, 0x00, \
0x07, 0x0e, 0x00, 0x00, 0x00, 0x07, 0x0e, 0x00, 0x00, 0x00, 0x0f, 0x1e, 0x00, 0x00, 0x07, 0xff, \
0xff, 0xe0, 0x00, 0x07, 0xff, 0xff, 0xf8, 0x00, 0x07, 0xff, 0xff, 0xfc, 0x00, 0x07, 0xff, 0xff, \
0xfe, 0x00, 0x00, 0x3f, 0x01, 0xff, 0x00, 0x00, 0x3f, 0x00, 0xff, 0x00, 0x00, 0x3f, 0x00, 0x7f, \
0x00, 0x00, 0x3f, 0x00, 0x7f, 0x00, 0x00, 0x3f, 0x00, 0x7f, 0x00, 0x00, 0x3f, 0x00, 0x7f, 0x00, \
0x00, 0x3f, 0x00, 0xfe, 0x00, 0x00, 0x3f, 0x87, 0xfc, 0x00, 0x00, 0x3f, 0xff, 0xfc, 0x00, 0x00, \
0x3f, 0xff, 0xfe, 0x00, 0x00, 0x3f, 0xff, 0xff, 0x00, 0x00, 0x3f, 0x80, 0xff, 0x80, 0x00, 0x3f, \
0x00, 0x3f, 0xc0, 0x00, 0x3f, 0x00, 0x1f, 0xc0, 0x00, 0x3f, 0x00, 0x1f, 0xc0, 0x00, 0x3f, 0x00, \
0x1f, 0xc0, 0x00, 0x3f, 0x00, 0x1f, 0xc0, 0x00, 0x3f, 0x00, 0x1f, 0xc0, 0x00, 0x3f, 0x00, 0x3f, \
0xc0, 0x00, 0x3f, 0x80, 0xff, 0x80, 0x03, 0xff, 0xff, 0xff, 0x00, 0x03, 0xff, 0xff, 0xfe, 0x00, \
0x07, 0xff, 0xff, 0xfc, 0x00, 0x07, 0xff, 0xff, 0xf0, 0x00, 0x00, 0x0f, 0x1e, 0x00, 0x00, 0x00, \
0x07, 0x0e, 0x00, 0x00, 0x00, 0x07, 0x0e, 0x00, 0x00, 0x00, 0x07, 0x0e, 0x00, 0x00, 0x00, 0x07, \
0x0e, 0x00, 0x00, 0x00, 0x07, 0x0e, 0x00, 0x00'},

    {'id': 'ETH',
     'name': 'ethereum',
     'bitmap': '0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, \
0x00, 0x36, 0x00, 0x00, 0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x00, 0x77, 0x00, 0x00, 0x00, 0x00, \
0xf7, 0x00, 0x00, 0x00, 0x00, 0xf7, 0x80, 0x00, 0x00, 0x01, 0xf7, 0xc0, 0x00, 0x00, 0x03, 0xf7, \
0xc0, 0x00, 0x00, 0x03, 0xf7, 0xe0, 0x00, 0x00, 0x07, 0xf7, 0xe0, 0x00, 0x00, 0x0f, 0xf7, 0xf0, \
0x00, 0x00, 0x0f, 0xf7, 0xf8, 0x00, 0x00, 0x1f, 0xe7, 0xf8, 0x00, 0x00, 0x1f, 0xc1, 0xfc, 0x00, \
0x00, 0x3e, 0x76, 0x7e, 0x00, 0x00, 0x79, 0xf7, 0x8e, 0x00, 0x00, 0x67, 0xf7, 0xf3, 0x00, 0x00, \
0x3f, 0xf7, 0xfc, 0x00, 0x00, 0x7f, 0xf7, 0xff, 0x00, 0x00, 0x7f, 0xf7, 0xfe, 0x00, 0x00, 0x1f, \
0xf7, 0xf8, 0x00, 0x00, 0x07, 0xf7, 0xf0, 0x00, 0x00, 0x41, 0xf7, 0xc3, 0x00, 0x00, 0x30, 0xf7, \
0x06, 0x00, 0x00, 0x3c, 0x36, 0x1c, 0x00, 0x00, 0x1e, 0x00, 0x78, 0x00, 0x00, 0x0f, 0x80, 0xf8, \
0x00, 0x00, 0x0f, 0xe3, 0xf0, 0x00, 0x00, 0x07, 0xf7, 0xe0, 0x00, 0x00, 0x03, 0xf7, 0xe0, 0x00, \
0x00, 0x01, 0xf7, 0xc0, 0x00, 0x00, 0x01, 0xf7, 0x80, 0x00, 0x00, 0x00, 0xf7, 0x00, 0x00, 0x00, \
0x00, 0x77, 0x00, 0x00, 0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x00, \
0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00'},

    {'id': 'LTC',
     'name': 'litecoin',
     'bitmap': '0x00, 0x00, 0x3f, 0x00, 0x00, 0x00, 0x00, 0xff, 0x80, 0x00, 0x00, 0x00, 0xff, 0x80, 0x00, 0x00, \
0x00, 0xff, 0x80, 0x00, 0x00, 0x00, 0xff, 0x80, 0x00, 0x00, 0x01, 0xff, 0x00, 0x00, 0x00, 0x01, \
0xff, 0x00, 0x00, 0x00, 0x01, 0xff, 0x00, 0x00, 0x00, 0x03, 0xff, 0x00, 0x00, 0x00, 0x03, 0xfe, \
0x00, 0x00, 0x00, 0x03, 0xfe, 0x00, 0x00, 0x00, 0x07, 0xfe, 0x00, 0x00, 0x00, 0x07, 0xfc, 0x00, \
0x00, 0x00, 0x07, 0xfc, 0x00, 0x00, 0x00, 0x07, 0xfc, 0x00, 0x00, 0x00, 0x0f, 0xfc, 0x00, 0x00, \
0x00, 0x0f, 0xf8, 0x00, 0x00, 0x00, 0x0f, 0xff, 0x80, 0x00, 0x00, 0x0f, 0xff, 0x80, 0x00, 0x00, \
0x1f, 0xff, 0x00, 0x00, 0x00, 0x1f, 0xff, 0x00, 0x00, 0x00, 0xff, 0xf8, 0x00, 0x00, 0x03, 0xff, \
0xe0, 0x00, 0x00, 0x03, 0xff, 0xe0, 0x00, 0x00, 0x03, 0xff, 0xe0, 0x00, 0x00, 0x03, 0x7f, 0xe0, \
0x00, 0x00, 0x00, 0x7f, 0xc0, 0x00, 0x00, 0x00, 0x7f, 0xc0, 0x00, 0x00, 0x00, 0x7f, 0xc0, 0x00, \
0x00, 0x00, 0xff, 0x80, 0x00, 0x00, 0x00, 0xff, 0x80, 0x00, 0x00, 0x00, 0xff, 0xff, 0xff, 0x80, \
0x01, 0xff, 0xff, 0xff, 0x80, 0x01, 0xff, 0xff, 0xff, 0x80, 0x01, 0xff, 0xff, 0xff, 0x80, 0x03, \
0xff, 0xff, 0xff, 0x80, 0x03, 0xff, 0xff, 0xff, 0x00, 0x03, 0xff, 0xff, 0xff, 0x00, 0x03, 0xff, \
0xff, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00'}
]


@app.route('/', methods=['GET'])
def home():
    return '''<h1>Coin Bitmap Collector</h1>
<p>A prototype API for getting details and bitmaps of coins.</p>'''


@app.route('/api/v1/resources/coins/all', methods=['GET'])
def api_all():
    results = []
    for coin in coins:
        results.append(coin['id'])

    return jsonify(results)


@app.route('/api/v1/resources/coins', methods=['GET'])
def api_id():
    # Check if an ID was provided as part of the URL.
    # If ID is provided, assign it to a variable.
    # If no ID is provided, display an error in the browser.
    print(request.args)
    if 'id' in request.args:
        id = request.args['id'].split(',')
    else:
        return "Error: No id field provided. Please specify an id."

    # Create an empty list for our results
    results = []

    # Loop through the data and match results that fit the requested ID.
    # IDs are unique, but other fields might return many results
    for coin in coins:
        if coin['id'] in id:
            results.append(coin)

    # Use the jsonify function from Flask to convert our list of
    # Python dictionaries to the JSON format.
    return jsonify(results)

app.run(host="0.0.0.0")